<!DOCTYPE html>
<html lang="en">
<head>
  <!-- 1. Required basics -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Alveary – Planner</title>

  <!-- 2. PWA / App metadata -->
  <link rel="manifest" href="./manifest.webmanifest">
  <meta name="theme-color" content="#596e5e">

  <!-- iOS support -->
  <link rel="apple-touch-icon" href="./img/icons/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="mobile-web-app-capable" content="yes">

  <!-- 2.5 MemberStack (must load early to read login state) -->
  <script>
    window.memberstackConfig = {
      useCookies: true,
      setCookieOnRootDomain: true
    };
  </script>
  
  <script
    data-memberstack-app="app_clbb9rspy00160ujl6tsxbsrj"
    src="https://static.memberstack.com/scripts/v1/memberstack.js"
    type="text/javascript">
  </script>

  <!-- 3. Fonts -->
  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,600;1,400&display=swap"
  />

  <!-- 4. CSS -->
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/schedule.css">
  <link rel="stylesheet" href="css/print-schedule.css">

  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="icon" type="image/png" href="img/Alveary%20Lt.%20Green.png">
</head>

<body x-data="coursePlanner()" x-init="init()">
  <!-- Auth refresh overlay -->
  <div
    x-show="authRefreshing"
    x-transition.opacity
    x-cloak
    class="fixed inset-0 z-[9999] flex items-center justify-center"
    style="background: rgba(0,0,0,0.25);"
  >
    <div class="bg-white rounded-2xl shadow-xl px-8 py-6 text-center">
      <div class="text-lg font-semibold mb-2">
        Sign in successful
      </div>
      <div class="text-sm opacity-70 mb-4">
        Gathering your schedule info…
      </div>
      <div class="animate-pulse text-sm">
        Loading…
      </div>
    </div>
  </div>

  <!-- Header -->
  <header class="app-header mb-8 px-6 md:px-16 py-4 md:py-6 flex flex-col md:flex-row md:items-center gap-4">
    <!-- Logo + wordmark -->
    <a href="https://www.alveary.org/alveary-2026-2027/dashboard" class="logo-link flex items-center gap-3" aria-label="Go to Alveary dashboard">
      <img
        src="img/Alveary%20Lt.%20Green.png"
        alt="Alveary logo"
        class="object-contain"
        style="height: 40px; width: 40px;"
      />
      <div class="logo-text-block">
        <span class="logo-title">Alveary</span>

        <!-- PRINT-ONLY: year under Alveary (left) -->
        <span class="print-year-left">2026–2027</span>
      </div>
    </a>

    <!-- Top-right: staff toggle + nav (screen only) -->
    <div class="mt-3 md:mt-0 md:ml-auto flex items-center justify-end gap-6 text-sm">
      <!-- Auth button: public + members -->
        <button
          id="auth-button"
          class="auth-button text-sm px-3 py-1.5 rounded border border-[#596e5e] text-[#596e5e] hover:bg-[#596e5e] hover:text-white transition"
          x-show="!isAuthed"
          @click="openAuth()"
        >
          Sign in
        </button>
      
      <!-- Staff-only: Edit mode (inline, before nav) -->
      <div
        class="toggle"
        x-show="isStaff"
        style="display:none"
        :class="editMode ? 'toggle--on' : ''"
        @click="toggleEditMode()"
      >
        <div class="toggle-switch">
          <div class="toggle-switch-knob"></div>
        </div>
        <span x-text="editMode ? 'Edit Mode' : 'Published'"></span>
      </div>
    
      <!-- navigation (stepper + menu) -->
      <div id="app-step-nav" class="app-step-nav"></div>
    </div>

    <!-- PRINT-ONLY: Course List + grade/master label on the right -->
    <div class="print-header-title-block">
      <div class="print-header-title">Schedule</div>
      <div class="print-header-grade" x-text="gradePrintLabel()"></div>
    </div>
    
  </header>

  <!-- PRINT-ONLY FOOTER -->
  <footer class="print-footer" aria-hidden="true">
    <div class="print-footer-left">Alveary Schedule</div>
    <div class="print-footer-center">©2026 Charlotte Mason Institute® All rights reserved.</div>
    <div class="print-footer-right">
      <span class="print-footer-grade" x-text="gradePrintLabel()"></span>
      <span class="print-page-number"></span>
    </div>
  </footer>

  <!-- Main content -->
  <main class="main-content px-6 lg:px-16 pb-16 space-y-10">

    <!-- GATE MESSAGE -->
    <section x-show="courseGate" x-cloak class="mt-6">
      <h2 class="section-title">Schedule Builder</h2>

      <div class="mt-6 p-6 rounded-lg border border-[#d2d6d2] bg-white max-w-2xl">
        <p class="text-sm text-[#596e5e] mb-4">
          This schedule builder is available to Alveary members.
        </p>
        <button
          class="auth-button text-sm px-4 py-2 rounded border border-[#596e5e] text-[#596e5e] hover:bg-[#596e5e] hover:text-white transition"
          @click="openAuth()"
        >
          Sign in to build your schedule
        </button>
      </div>
    </section>

    <!-- PAGE CONTENT -->
    <div x-show="!courseGate" x-cloak>
      <section>
        <h2 class="section-title">Schedule Builder</h2>

        <div class="mt-6 grid grid-cols-1 lg:grid-cols-[380px_1fr] gap-6">
          <!-- Left rail -->
          <div class="p-4 rounded-lg border border-[#e5e8e5] bg-white">
            <div class="text-sm font-semibold mb-2">Scheduling Cards</div>
            <div class="text-sm opacity-70">Coming next: grade/student pickers + draggable card list.</div>
          </div>

          <!-- Right build area -->
          <div class="p-4 rounded-lg border border-[#e5e8e5] bg-white">
            <div class="text-sm font-semibold mb-2">Week Builder</div>
            <div class="text-sm opacity-70">Coming next: Mon–Fri columns + time totals + drop zones.</div>
          </div>
        </div>
      </section>
    </div>

  </main>
  
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script type="module" src="js/auth.js"></script>
  <script src="js/app.js"></script>
  
</body>
</html>
