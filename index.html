<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Alveary – Planner</title>

  <!-- Fonts -->
  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,600;1,400&display=swap"
  />
  
  <!-- CSS -->
  <link rel="stylesheet" href="css/styles.css">

  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Alpine.js for simple interactivity -->
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

</head>

<body x-data="coursePlanner()" x-init="init()">

  <!-- Header -->
  <header class="app-header mb-8 px-6 md:px-16 py-4 md:py-6 flex flex-col md:flex-row md:items-center gap-4">
    <!-- Logo + wordmark -->
    <div class="flex items-center gap-3">
      <!-- Replace src with new dark green logo file when ready -->
      <img
        src="img/Alveary%20Lt.%20Green.png"
        alt="Alveary logo"
        class="object-contain"
        style="height: 40px; width: 40px;"
      />
      <span class="logo-title">Alveary</span>
    </div>

    <!-- Top-right navigation tabs -->
    <nav
      class="mt-3 md:mt-0 md:ml-auto flex flex-wrap items-center gap-x-6 gap-y-2 text-sm"
    >
      <a
        href="index.html"
        class="nav-tab nav-tab-active"
      >
        Course list
      </a>
    
      <a
        href="books.html"
        class="nav-tab"
      >
        Book list
      </a>
    </nav>
    
  </header>

  <!-- Main content -->
  <main class="max-w-6xl mx-auto px-6 lg:px-16 pb-16 space-y-10">

    <!-- Course list -->
    <section>
      <h2 class="section-title">Course list</h2>
      <p class="section-subtitle">
        This is an intuitive course planner that helps organize your school year.
        Browse courses by subject, view descriptions and placement tips, and easily tag, note,
        or save your selections for a personalized learning plan.
      </p>

      <!-- Filter bar -->
      <div class="mt-8 flex justify-center">
        <div class="filter-panel">
          <p class="filter-panel-title">Filter by</p>

          <div class="filter-grid">
            <!-- Grade -->
            <div class="relative" @click.outside="gradeDropdownOpen = false">
              <button
                type="button"
                id="filter-grade"
                class="filter-control"
                aria-label="Filter by grade"
                @click="gradeDropdownOpen = !gradeDropdownOpen"
              >
                <!-- placeholder when nothing selected -->
                <template x-if="selectedGrades.length === 0">
                  <span class="filter-placeholder">Grade</span>
                </template>

                <!-- chips when grades are selected -->
                <template x-if="selectedGrades.length > 0">
                  <div class="filter-control-chips">
                    <template x-for="code in selectedGrades" :key="code">
                      <span class="filter-chip">
                        <span x-text="gradeLabelFromCode(code)"></span>
                        <button
                          type="button"
                          class="filter-chip-remove"
                          @click.stop="removeGrade(code)"
                          aria-label="Remove grade"
                        >
                          ×
                        </button>
                      </span>
                    </template>
                  </div>
                </template>

                <span
                  class="filter-chevron"
                  :class="gradeDropdownOpen ? 'filter-chevron-open' : ''"
                  aria-hidden="true"
                >
                  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path
                      d="M6 9l6 6 6-6"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </span>
              </button>

              <!-- dropdown menu -->
              <div
                class="filter-dropdown"
                x-show="gradeDropdownOpen"
                x-transition
              >
                <template x-for="opt in gradeOptions" :key="opt.code">
                  <button
                    type="button"
                    class="filter-dropdown-item"
                    @click="toggleGrade(opt.code)"
                  >
                    <span x-text="opt.label"></span>
                    <span
                      class="filter-dropdown-check"
                      x-show="selectedGrades.includes(opt.code)"
                    >
                      ✓
                    </span>
                  </button>
                </template>
              </div>
            </div>

            <!-- Subject -->
            <div class="relative" @click.outside="subjectDropdownOpen = false">
              <button
                type="button"
                id="filter-subject"
                class="filter-control"
                aria-label="Filter by subject"
                @click="subjectDropdownOpen = !subjectDropdownOpen"
              >
                <!-- placeholder when nothing selected -->
                <template x-if="selectedSubjects.length === 0">
                  <span class="filter-placeholder">Subject</span>
                </template>
            
                <!-- chips when subjects are selected -->
                <template x-if="selectedSubjects.length > 0">
                  <div class="filter-control-chips">
                    <template x-for="subj in selectedSubjects" :key="subj">
                      <span
                        class="filter-chip"
                        :style="`background-color: ${subjectColor(subj)}4D;`"
                      >
                        <span x-text="subj"></span>
                        <button
                          type="button"
                          class="filter-chip-remove"
                          @click.stop="removeSubject(subj)"
                          aria-label="Remove subject"
                        >
                          ×
                        </button>
                      </span>
                    </template>
                  </div>
                </template>
            
                <span
                  class="filter-chevron"
                  :class="subjectDropdownOpen ? 'filter-chevron-open' : ''"
                  aria-hidden="true"
                >
                  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path
                      d="M6 9l6 6 6-6"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </span>
              </button>
            
              <!-- dropdown menu -->
              <div
                class="filter-dropdown"
                x-show="subjectDropdownOpen"
                x-transition
              >
                <template x-for="opt in subjectOptions" :key="opt">
                  <button
                    type="button"
                    class="filter-dropdown-item"
                    @click="toggleSubject(opt)"
                  >
                    <span x-text="opt"></span>
                    <span
                      class="filter-dropdown-check"
                      x-show="selectedSubjects.includes(opt)"
                    >
                      ✓
                    </span>
                  </button>
                </template>
              </div>
            </div>

            <!-- Tags -->
            <div class="relative" @click.outside="tagDropdownOpen = false">
              <button
                type="button"
                id="filter-tags"
                class="filter-control"
                aria-label="Filter by planning tag"
                @click="tagDropdownOpen = !tagDropdownOpen"
              >
                <!-- placeholder when nothing selected -->
                <template x-if="selectedTags.length === 0">
                  <span class="filter-placeholder">Planning tag</span>
                </template>
            
                <!-- chips when tags are selected -->
                <template x-if="selectedTags.length > 0">
                  <div class="filter-control-chips">
                    <template x-for="tagId in selectedTags" :key="tagId">
                      <span class="filter-chip">
                        <span x-text="planningTagLabel(tagId)"></span>
                        <button
                          type="button"
                          class="filter-chip-remove"
                          @click.stop="removeSelectedTag(tagId)"
                          aria-label="Remove tag"
                        >
                          ×
                        </button>
                      </span>
                    </template>
                  </div>
                </template>
            
                <span
                  class="filter-chevron"
                  :class="tagDropdownOpen ? 'filter-chevron-open' : ''"
                  aria-hidden="true"
                >
                  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path
                      d="M6 9l6 6 6-6"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="1.8"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </span>
              </button>
            
              <!-- dropdown menu -->
              <div
                class="filter-dropdown"
                x-show="tagDropdownOpen"
                x-transition
              >
                <template x-for="opt in planningTagOptions" :key="opt.id">
                  <button
                    type="button"
                    class="filter-dropdown-item"
                    @click="toggleSelectedTag(opt.id)"
                  >
                    <div class="planning-tag-option-main">
                      <img
                        :src="opt.img"
                        :alt="opt.label"
                      />
                      <span x-text="opt.label"></span>
                    </div>
                    <span
                      class="filter-dropdown-check"
                      x-show="selectedTags.includes(opt.id)"
                    >
                      ✓
                    </span>
                  </button>
                </template>
              </div>
            </div>

            <!-- Search -->
            <div>
              <div class="filter-control" aria-label="Search courses or topics">
                <input
                  id="filter-search"
                  type="search"
                  placeholder="Search"
                  autocomplete="off"
                />
                <span class="search-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <circle
                      cx="11"
                      cy="11"
                      r="6.5"
                      stroke="currentColor"
                      stroke-width="1.8"
                      fill="none"
                    />
                    <line
                      x1="15"
                      y1="15"
                      x2="20"
                      y2="20"
                      stroke="currentColor"
                      stroke-width="1.8"
                      stroke-linecap="round"
                    />
                  </svg>
                </span>
              </div>
            </div>
          </div>

          <div class="filter-actions">
            <!-- Left: clear + print buttons -->
            <div class="flex gap-2">
              <button type="button" class="btn-pill" @click="clearAllFilters()">
                <span class="btn-pill-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <line x1="6" y1="6" x2="18" y2="18"
                          stroke="currentColor" stroke-width="1.8" stroke-linecap="round" />
                    <line x1="18" y1="6" x2="6" y2="18"
                          stroke="currentColor" stroke-width="1.8" stroke-linecap="round" />
                  </svg>
                </span>
                <span>Clear selected</span>
              </button>

              <button type="button" class="btn-pill btn-secondary print-btn">
                <span class="btn-pill-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <rect x="5" y="9" width="14" height="9" rx="1.5" ry="1.5"
                          fill="none" stroke="currentColor" stroke-width="1.8" />
                    <path d="M8 9V5h8v4"
                          fill="none" stroke="currentColor" stroke-width="1.8" />
                    <rect x="9" y="13" width="6" height="4"
                          fill="none" stroke="currentColor" stroke-width="1.5" />
                    <circle cx="17" cy="12" r="0.9" fill="currentColor" />
                  </svg>
                </span>
                <span>Print</span>
              </button>
            </div>

            <!-- Right: toggles -->
            <div class="flex gap-4 justify-start md:justify-end flex-wrap">
              <div
                class="toggle"
                :class="showAllDetails ? 'toggle--on' : ''"
                @click="toggleAllDetails()"
              >
                <div class="toggle-switch">
                  <div class="toggle-switch-knob"></div>
                </div>
                <span>Show descriptions &amp; tips</span>
              </div>

              <div class="toggle">
                <div class="toggle-switch">
                  <div class="toggle-switch-knob"></div>
                </div>
                <span>Show my courses only</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Dynamic course list -->
      <div class="course-list-shell mt-10">
      
        <!-- Loading & error states -->
        <p x-show="isLoadingCourses" class="text-sm text-muted">Loading courses…</p>
        <p x-show="!isLoadingCourses && loadError" class="text-sm text-red-600" x-text="loadError"></p>
      
        <!-- Subjects, courses, and topics -->
        <template x-if="!isLoadingCourses && !loadError">
          <div>
            <template x-for="(courseGroup, subjectName) in coursesBySubject" :key="subjectName">
              <section
                class="subject-block"
                :class="'subject--' + subjectName.toLowerCase().replace(/[^a-z0-9]+/g, '-')"
              >
                <h3 class="subject-title" x-text="subjectName"></h3>
      
                <div class="subject-courses">
                  <template x-for="course in courseGroup" :key="course.id">
                    <article class="course-card" :style="`border-color: ${subjectColor(course.subject)}`">
                      <!-- Title row with chevron -->
                      <div class="card-header">
                        <h4 class="course-title" x-text="course.title"></h4>

                          <!-- Chevron only if description or tips exist -->
                          <template x-if="course.description || course.tips">
                            <button
                              type="button"
                              class="card-toggle"
                              :class="course.detailsOpen ? '' : 'card-toggle--closed'"
                              @click="course.detailsOpen = !course.detailsOpen"
                              aria-label="Toggle course details"
                            >
                              <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path
                                  d="M6 9l6 6 6-6"
                                  fill="none"
                                  stroke="currentColor"
                                  stroke-width="1.8"
                                  stroke-linecap="round"
                                  stroke-linejoin="round"
                                />
                              </svg>
                            </button>
                          </template>
                      </div>
                    
                      <!-- grade + schedule line -->
                      <p
                        class="course-meta"
                        x-show="course.gradeText || course.schedText"
                      >
                        <!-- left: schedule (if any) -->
                        <template x-if="course.schedText">
                          <span
                            class="meta-schedule"
                            :class="course.gradeText ? 'meta-schedule--with-grade' : 'meta-schedule--solo'"
                            x-text="course.schedText"
                          ></span>
                        </template>
                      
                        <!-- middle: grade (if any) -->
                        <template x-if="course.gradeText">
                          <span
                            :class="course.schedText ? 'meta-grade meta-grade--with-sched' : 'meta-grade meta-grade--solo'"
                            x-text="course.gradeText"
                          ></span>
                        </template>
                      
                        <!-- spacer pushes planning tag area to far right -->
                        <span class="meta-flex-spacer"></span>

                        <!-- right: planning tag UI (courses *without* topics only) -->
                        <template x-if="!course.topics || course.topics.length === 0">
                          <span class="planning-tag-region">
                            <!-- If no tags yet: show "+ Planning tag" button -->
                            <template x-if="!course.planningTags || course.planningTags.length === 0">
                              <button
                                type="button"
                                class="planning-tag-button"
                                aria-label="Add planning tag to course"
                                @click.stop="openPlanningMenu($event, course)"
                              >
                                <span class="planning-tag-label">+ Planning tag</span>
                              </button>
                            </template>

                            <!-- If tags exist: show images + small "+" square -->
                            <template x-if="course.planningTags && course.planningTags.length > 0">
                              <div class="planning-tag-selected-row">
                                <template x-for="tag in course.planningTags" :key="tag.id">
                                  <div class="planning-tag-pill">
                                    <img
                                      class="planning-tag-img"
                                      :src="tag.img"
                                      :alt="tag.label"
                                    />
                                    <button
                                      type="button"
                                      class="planning-tag-remove"
                                      @click.stop="removePlanningTag(course, tag.id)"
                                      aria-label="Remove planning tag"
                                    >
                                      ×
                                    </button>
                                  </div>
                                </template>

                                <button
                                  type="button"
                                  class="planning-tag-add"
                                  aria-label="Add more planning tags"
                                  @click.stop="openPlanningMenu($event, course)"
                                >
                                  +
                                </button>
                              </div>
                            </template>
                          </span>
                        </template>
                      </p>
                    
                      <!-- Description + combining tips -->
                      <div
                        class="course-detail-row"
                        x-show="showAllDetails && course.detailsOpen && (course.description || course.tips)"
                        x-transition
                      >
                        <div
                          class="course-detail-description"
                          x-show="course.description"
                          x-text="course.description"
                        ></div>
                    
                        <div
                          class="course-detail-tips"
                          x-show="course.tips"
                        >
                          <span class="course-detail-tips-icon" aria-hidden="true">
                            <!-- “join” icon -->
                            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                              <circle
                                cx="9"
                                cy="12"
                                r="4"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="1.7"
                              />
                              <circle
                                cx="15"
                                cy="12"
                                r="4"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="1.7"
                              />
                            </svg>
                          </span>
                          <span x-text="course.tips"></span>
                        </div>
                      </div>
      
                      <!-- Nested topics (titles only for now) -->
                      <div class="topic-list" x-show="course.topics.length">
                        <template x-for="topic in course.topics" :key="topic.recordID">
                          <article class="topic-card">
                            <!-- Title row with chevron -->
                            <div class="card-header">
                              <h5 class="topic-title" x-text="topic.Topic"></h5>

                                <!-- Chevron only if description or tips exist -->
                                <template x-if="topic.description || topic.tips">
                                  <button
                                    type="button"
                                    class="card-toggle"
                                    :class="topic.detailsOpen ? '' : 'card-toggle--closed'"
                                    @click="topic.detailsOpen = !topic.detailsOpen"
                                    aria-label="Toggle topic details"
                                  >
                                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                      <path
                                        d="M6 9l6 6 6-6"
                                        fill="none"
                                        stroke="currentColor"
                                        stroke-width="1.8"
                                        stroke-linecap="round"
                                        stroke-linejoin="round"
                                      />
                                    </svg>
                                  </button>
                                </template>
                            </div>
                          
                              <p
                                class="course-meta topic-meta"
                                x-show="topic.gradeText || topic.schedText"
                              >
                                <!-- left: schedule -->
                                <template x-if="topic.schedText">
                                  <span
                                    class="meta-schedule"
                                    :class="topic.gradeText ? 'meta-schedule--with-grade' : 'meta-schedule--solo'"
                                    x-text="topic.schedText"
                                  ></span>
                                </template>
                              
                                <!-- middle: grade -->
                                <template x-if="topic.gradeText">
                                  <span
                                    :class="topic.schedText ? 'meta-grade meta-grade--with-sched' : 'meta-grade meta-grade--solo'"
                                    x-text="topic.gradeText"
                                  ></span>
                                  
                                  <!-- spacer -->
                                  <span class="meta-flex-spacer"></span>
                                  
                                  <!-- topic bookmark (My courses) -->
                                  <span class="bookmark-region">
                                    <!-- Bookmarked here (solid, subject-colored) -->
                                    <template x-if="isTopicBookmarked(topic)">
                                      <button
                                        type="button"
                                        class="bookmark-btn bookmark-btn--solid"
                                        :style="{ backgroundColor: subjectColor(course.subject) }"
                                        @click.stop="toggleTopicBookmark(topic)"
                                        aria-label="Remove from My courses"
                                      >
                                        <svg viewBox="0 0 24 24" aria-hidden="true" class="bookmark-icon">
                                          <path d="M7 4h10a1 1 0 0 1 1 1v15l-6-3-6 3V5a1 1 0 0 1 1-1z" />
                                        </svg>
                                      </button>
                                    </template>
                                  
                                    <!-- Ghost bookmark (bookmarked in another course, not here) -->
                                    <template x-if="!isTopicBookmarked(topic) && topicBookmarkedElsewhere(topic)">
                                      <div class="bookmark-ghost-wrapper">
                                        <button
                                          type="button"
                                          class="bookmark-btn bookmark-btn--ghost"
                                          :style="{ backgroundColor: subjectColor(course.subject) }"
                                          @click.stop="applyBookmarkFromElsewhere(topic)"
                                          aria-label="Add this topic to My courses here"
                                        >
                                          <svg viewBox="0 0 24 24" aria-hidden="true" class="bookmark-icon">
                                            <path d="M7 4h10a1 1 0 0 1 1 1v15l-6-3-6 3V5a1 1 0 0 1 1-1z" />
                                          </svg>
                                        </button>
                                        <span class="bookmark-ghost-label">Already bookmarked</span>
                                      </div>
                                    </template>
                                  
                                    <!-- Empty bookmark (nowhere yet) -->
                                    <template x-if="!isTopicBookmarked(topic) && !topicBookmarkedElsewhere(topic)">
                                      <button
                                        type="button"
                                        class="bookmark-btn bookmark-btn--empty"
                                        @click.stop="toggleTopicBookmark(topic)"
                                        aria-label="Add to My courses"
                                      >
                                        <svg viewBox="0 0 24 24" aria-hidden="true" class="bookmark-icon">
                                          <path
                                            d="M8 5h8a1 1 0 0 1 1 1v11.5l-5-2.5-5 2.5V6a1 1 0 0 1 1-1z"
                                            fill="none"
                                            stroke="currentColor"
                                            stroke-width="1.6"
                                            stroke-linejoin="round"
                                          />
                                          <path
                                            d="M12 7v4m-2-2h4"
                                            fill="none"
                                            stroke="currentColor"
                                            stroke-width="1.6"
                                            stroke-linecap="round"
                                          />
                                        </svg>
                                      </button>
                                    </template>
                                  </span>

                                <!-- right: planning tag UI (topics always can have tags) -->
                                <span class="planning-tag-region">
                                  <!-- No tags yet -->
                                  <template x-if="!topic.planningTags || topic.planningTags.length === 0">
                                    <button
                                      type="button"
                                      class="planning-tag-button"
                                      aria-label="Add planning tag to topic"
                                      @click.stop="openPlanningMenu($event, topic)"
                                    >
                                      <span class="planning-tag-label">+ Planning tag</span>
                                    </button>
                                  </template>

                                  <!-- Tags selected -->
                                  <template x-if="topic.planningTags && topic.planningTags.length > 0">
                                    <div class="planning-tag-selected-row">
                                      <template x-for="tag in topic.planningTags" :key="tag.id">
                                        <div class="planning-tag-pill">
                                          <img
                                            class="planning-tag-img"
                                            :src="tag.img"
                                            :alt="tag.label"
                                          />
                                          <button
                                            type="button"
                                            class="planning-tag-remove"
                                            @click.stop="removePlanningTag(topic, tag.id)"
                                            aria-label="Remove planning tag"
                                          >
                                            ×
                                          </button>
                                        </div>
                                      </template>

                                      <button
                                        type="button"
                                        class="planning-tag-add"
                                        aria-label="Add more planning tags"
                                        @click.stop="openPlanningMenu($event, topic)"
                                      >
                                        +
                                      </button>
                                    </div>
                                  </template>

                                  <!-- Ghost tags from previous use of this topic elsewhere -->
                                  <template x-if="missingGlobalTagsForTopic(topic).length > 0">
                                    <div class="planning-tag-selected-row">
                                      <template
                                        x-for="tagId in missingGlobalTagsForTopic(topic)"
                                        :key="'ghost-' + tagId"
                                      >
                                        <div class="planning-tag-pill">
                                          <img
                                            class="planning-tag-img planning-tag-img-ghost"
                                            :src="planningTagImage(tagId)"
                                            :alt="planningTagLabel(tagId)"
                                          />
                                          <button
                                            type="button"
                                            class="planning-tag-apply"
                                            @click.stop="applyGlobalTagToTopic(topic, tagId)"
                                            :aria-label="`Apply ${planningTagLabel(tagId)} here`"
                                            title="Add previous tag"
                                          >
                                            +
                                          </button>
                                        </div>
                                      </template>
                                    </div>
                                  </template>
                                  
                                </span>
                              </p>

                            <div
                              class="course-detail-row"
                              x-show="showAllDetails && topic.detailsOpen && (topic.description || topic.tips)"
                              x-transition
                            >
                              <div
                                class="course-detail-description"
                                x-show="topic.description"
                                x-text="topic.description"
                              ></div>
                          
                              <div
                                class="course-detail-tips"
                                x-show="topic.tips"
                              >
                                <span class="course-detail-tips-icon" aria-hidden="true">
                                  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <circle
                                      cx="9"
                                      cy="12"
                                      r="4"
                                      fill="none"
                                      stroke="currentColor"
                                      stroke-width="1.7"
                                    />
                                    <circle
                                      cx="15"
                                      cy="12"
                                      r="4"
                                      fill="none"
                                      stroke="currentColor"
                                      stroke-width="1.7"
                                    />
                                  </svg>
                                </span>
                                <span x-text="topic.tips"></span>
                              </div>
                            </div>
                          </article>

                        </template>
                      </div>
                      
                    </article>
                  </template>
                </div>
              </section>
              
            </template>
          </div>
        </template>
      </div>

      <!-- Global planning-tag menu (modal-style, for both courses & topics) -->
      <div
        x-show="planningMenuOpen"
        x-transition
        x-cloak
        class="fixed inset-0 z-50"
      >
        <!-- click-away backdrop -->
        <div class="absolute inset-0" @click="closePlanningMenu()"></div>

        <!-- floating menu positioned near the clicked button -->
        <div
          class="planning-tag-menu fixed"
          :style="`top:${planningMenuY}px; left:${planningMenuX}px;`"
          @click.stop
        >
          <template x-for="opt in planningTagOptions" :key="opt.id">
            <button
              type="button"
              class="planning-tag-option"
              @click="togglePlanningTag(planningMenuItem, opt)"
            >
              <span class="planning-tag-option-main">
                <img :src="opt.img" :alt="opt.label" />
                <span x-text="opt.label"></span>
              </span>
              <span
                class="filter-dropdown-check"
                x-show="
                  planningMenuItem &&
                  planningMenuItem.planningTags &&
                  planningMenuItem.planningTags.some(t => t.id === opt.id)
                "
              >
                ✓
              </span>
            </button>
          </template>
        </div>
      </div>
      
    </section>

  </main>

  <script src="js/app.js"></script>
  
</body>
</html>
